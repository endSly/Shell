<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<style>
  html {
    background: white;
  }
  body {
    margin: 0;
    padding: 0;
    background-color: black;
  }

  .terminal {
    float: left;
    font-family: "Menlo-Regular", monospace;
    font-size: 10px;
    color: #f0f0f0;
    background: #000;
  }

  .terminal-cursor {
    color: #000;
    background: #f0f0f0;
  }

</style>
<script src="./term.js"></script>
</head>
<body>
<script>

function getSize() {
  var dummyEl = document.createElement('div')
    , bodyEl = document.getElementsByTagName('body')[0];
  
  dummyEl.className = 'terminal';
  dummyEl.innerHTML = '<span>&nbsp;</span>'
  bodyEl.appendChild(dummyEl);

  var colWidth      = dummyEl.offsetWidth - 1;
  var rowHeight     = dummyEl.offsetHeight;
  var clientWidth   = document.body.clientWidth;
  var clientHeight  = document.documentElement.clientHeight;

  bodyEl.removeChild(dummyEl);

  return {
    cols: Math.floor(clientWidth / colWidth),
    rows: Math.floor(clientHeight / rowHeight)
  };
};

function adjustToWindow() {
  var size = getSize();
  window.term.resize(size.cols, size.rows);
};

;(function() {
  window.onload = function() {
    var term = window.term = new Terminal({
      colors: Terminal.xtermColors
    });

    term.on('data', function(data) {
      window.location = "term-write://app/data#"+escape(data);
    });

    term.on('title', function(title) {
      window.location = "term-title://app/title#"+escape(title);
    });

    window.location = "term-will-appear://app"
        
    term.open(document.body);

    window.location = "term-did-appear://app"
  };

  window.onresize = function() {
    window.location = "term-resize://app";
  };
}).call(this);
</script>
</body>
</html>
